# Бот-администратор для проекта Атом-лаб

## Введение

У образовательного проекта под каждый новый поток создается
20+ чатов в телеграме. Участники в них общаются и учатся. Задача бота: управлять этими чатами

*Мой личный pet-проект. В процессе разработки*


### Установка зависимостей
```
pip install -r requirements.txt
```

## Настройка
Создается .env файл в папке config

### Cодержание .env
```python
TOKEN = '' #токен бота с @botFather

# используется PostgreSQL
# PASSWORD - пароль подключения к БД
# NAMEDATABASE - название базы
# USERNAME - имя пользователя 
PostSQL_host = 'postgresql+asyncpg://USERNAME:PASSWORD@localhost/NAMEDATABASE' 
ROOT = ... # ID владельца
ROOT_CHAT = ... # ID чата владельца (равен ID владельца)
```

## Функции и возможности 
### User handlers — handlers.py

**/start** — приветствует пользователя<br>
**Reply + '+rep'** — увеличить карму. Нужно ответить на сообщение и написать +rep, тогда карма того,
кто помог увеличится. Если просто написать +rep, то ничего не произойдет. По умолчанию у пользователя 5 единиц кармы для раздачи

### Admin handlers — adminpanel.py
Фильтруется через RootProtect(). True - если пользователь имеет id == ROOT в файле .env['ROOT']


**/rpanel** — заглушка для будущей панели администратора<br>
**/chatid** — получить ID конкретного чата, в котором вызван. Отправляет вывод в чат с рут-пользователем<br>
**/addchat** — регистрирует чат в БД вручную<br>
**/send** — отправляет сообщение во все чаты, которые зарегистрированные в БД<br>


**/checkme** — временная функция, которая имитирует вступление пользователя в несколько чатов 


# Описание файлов
> **run.py** — Основной файл, запускающий работу бота<br>
> **config.py** — Файл конфигурации. Пока что имеет только функцию get_tokens(name), который выгружает нужные сведения из .env файла<br>
>
> **handlers.py** — Хэндлеры для пользователей <br>
> **adminpanel.py** —  Хэндлеры для администратора <br>
> 
> **stateuser.py** — Состояния пользователя. На данный момент используется только для команды /send <br>
> **keyboards.py** — Кнопки для сообщений и бота. На данный момент используется только для команды /send <br>
> **middlewares.py** — Фильтры и миддлвары <br>
>
> **models.py** — Cоздание нужных таблиц в БД <br>
> **request.py** — Запросы к БД <br>
>
> **user_request.py** — Пользовательские запросы (временный файл для удобства)<br>

